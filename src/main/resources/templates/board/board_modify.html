<!doctype html>
<html lang="en" dir="ltr"
	xmlns:th="http://www.thymeleaf.org">

<head>
<style>
	.content-header{margin-top:30px;}
	.end-button
	{
		width:85px;
		height:40px;
		background-color:#768BF5;
		border:0px;
		margin-top:-15px;
	}
	.end{margin-left:10px;}
</style>
<!-- 공통 헤더 -->
<th:block th:include="/../fragments/header.html"></th:block>

</head>

<body class="layout-light top-menu overlayScroll">
	<div class="mobile-search"></div>
	
	<div class="mobile-author-actions"></div>
	
	<!-- 공통 topbar -->
	<th:block th:include="/../fragments/topbar.html"></th:block>
	
	<main class="main-content" style="background-color: #F9FBFD;">
	
		<div class="contents" style="background-color: #F9FBFD;">
    
		    <div class="container-fluid">
		    	<div class="row">
			        <div class="col-lg-12">
			        	<div class="breadcrumb-main" style="float: left;">
			        		<h4 class="text-capitalize breadcrumb-title">전달사항</h4>
			        		<span class="ml-20 mt-1">일정관리-전달사항</span>
			        	</div>
			        </div>
		        </div>
		    	<div class="row">
			        <div class="col-lg-12">
			        	<div class="card">
			        		<div class="card-body">
		        				<div class="row mt-3">
		        					<div class="col-sm-2 d-flex aling-items-center">
		                            	<label for="reagent_standard" class="color-dark align-center">제목<span style="color: red;">*</span></label>
		                            </div>
		                            <div class="col-sm-5">
		                                <input type="text" class="form-control b-light" id="board_title" th:value="${board.board_title}">		                            </div>
		                    	</div>
		                         <div class="row mt-3">
		        					<div class="col-sm-2 d-flex aling-items-center">
		                            	<label for="reagent_name" class="color-dark align-center">시작일<span style="color: red;">*</span></label>
		                            </div>
		                            <div class="col-sm-5">
		                                <input type="text" class="form-control b-light" id="board_start" th:value="${board.board_start}">
		                            </div>
		                    	</div>
		                    	<div class="row mt-3">
		        					<div class="col-sm-2 d-flex aling-items-center">
		                            	<label for="reagent_standard" class="color-dark align-center">종료일<span style="color: red;">*</span></label>
		                            </div>
		                            <div class="col-sm-5">
		                                <input type="text" class="form-control b-light" id="board_end" th:value="${board.board_end}">
		                            </div>
		                    	</div>
		                    	<div class="row mt-3">
		        					<div class="col-sm-2 d-flex aling-items-center">
		                            	<label for="reagent_formula" class="color-dark align-center">일정내용<span style="color: red;">*</span></label>
		                            </div>
		                            <div class="col-sm-5">
		                                <textarea rows="3" col="12" id="board_content" style="bord-radius:5px; width:100%; height:auto; border:1px solid #d9d9d9" th:text="${board.board_content}"></textarea>
		                            </div>
		                    	</div>
		                    	<div class="row mt-3">
		        					<div class="col-sm-2 d-flex aling-items-center">
		                            	<label for="reagent_nick_e" class="color-dark align-center">일정공유<span style="color: red;">*</span></label>
		                            </div>
		                            <div class="col-sm-5">
		                            	<div>
		                                	<input type="checkbox" onclick = "selectAll(this)">
		                                	<span> 전체 선택</span>
		                                </div>
		                                <th:block th:each = "b : ${userGroup}">
			                                	<div>
			                                		<input type="checkbox" th:value = "${b.user_id}" name="user_id"  th:if="${b.D1_id}== 1" checked>
			                                		<input type="checkbox" th:value = "${b.user_id}" name="user_id"  th:if="${b.D1_id}!= 1" check>
			                                		<span th:text="${b.user_name_k}"></span>
			                                	</div>
		                                </th:block>
		                            </div>
		                    	</div>
		                    	
			        		</div>
			        	</div>
			        </div>
		        </div>
		        <div class="row">
					<div class="col-4">
						<div class="action-btn d-flex justify-content-frist mt-30"></div>
					</div>
					<div class="col-4">
						<div class="d-flex justify-content-center mt-30"></div>
					</div>
					<div class="col-4">
						<div class="action-btn d-flex justify-content-end mt-30">
							<a href="/data/reagent" class="btn btn-primary end-button end">목록</a>
							<button type="button" class="btn btn-default btn-danger end-button end" onclick="DeleteBtn();">삭제</button>
		                	<button type="button" class="btn btn-default btn-primary end-button end" onclick="UpdateBtn();">수정</button>
						</div>
					</div>
				</div>
		        <div class="atbd-notice" id="success_popup" style="width:100vw; height:90vh; position:fixed; left:0px; top:0px; display:none; justify-content: center; align-items:center;">
		        	<div class="card card-default card-md mb-4" style="border:1px solid #eee; width: 30%; height: 40%;">
		        		<div class="card-body">
		        			<div class="atbd-notice__content">
		        				<div class="atbd-notice__top text-center">
		        					<div class="atbd-notice__icon bg-success">
		        						<i class="fas fa-check color-white"></i>
		        					</div>
		        					<div class="atbd-notice__text">
		        						<h4 id="success_text"></h4>
		        					</div>
		        					<div style="display: flex; justify-content: center; margin: 10% auto;">
		        						<a class="btn btn-default btn-success" href="/data/reagent" style="color: #FFFFFF;">확인</a>
		        					</div>
		        				</div>
		        			</div>
		        		</div>
		        	</div>
		        </div>
		        <div class="atbd-notice" id="update_popup" style="width:100vw; height:90vh; position:fixed; left:0px; top:0px; display:none; justify-content: center; align-items:center;">
		        	<div class="card card-default card-md mb-4" style="border:1px solid #eee; width: 20%; height: 25%;">
		        		<div class="card-body">
		        			<div class="atbd-notice__content">
		        				<div class="atbd-notice__top text-center">
		        					<div class="atbd-notice__icon bg-info">
		        						<i class="fas fa-exclamation color-white"></i>
		        					</div>
		        					<div class="atbd-notice__text">
		        						<h4>수정하시겠습니까?</h4>
		        					</div>
		        					<div style="display: flex; justify-content: center; margin: 10% auto;">
		        						<button class="btn btn-default btn-primary mr-10" onclick="updateConfirm();" style="color: #FFFFFF;">수정</button>
		        						<button class="btn btn-default btn-danger" onclick="CancelBtn();" style="color: #FFFFFF;">취소</button>
		        					</div>
		        				</div>
		        			</div>
		        		</div>
		        	</div>
		        </div>
		        <div class="atbd-notice" id="delete_popup" style="width:100vw; height:90vh; position:fixed; left:0px; top:0px; display:none; justify-content: center; align-items:center;">
		        	<div class="card card-default card-md mb-4" style="border:1px solid #eee; width: 20%; height: 25%;">
		        		<div class="card-body">
		        			<div class="atbd-notice__content">
		        				<div class="atbd-notice__top text-center">
		        					<div class="atbd-notice__icon bg-danger">
		        						<i class="fas fa-exclamation-triangle color-white"></i>
		        					</div>
		        					<div class="atbd-notice__text">
		        						<h4>삭제하시겠습니까?</h4>
		        					</div>
		        					<div style="display: flex; justify-content: center; margin: 10% auto;">
		        						<button class="btn btn-default btn-primary mr-10" onclick="deleteConfirm();" style="color: #FFFFFF;">삭제</button>
		        						<button class="btn btn-default btn-danger" onclick="CancelBtn();" style="color: #FFFFFF;">취소</button>
		        					</div>
		        				</div>
		        			</div>
		        		</div>
		        	</div>
		        </div>
		    </div>
		    
		    <div class="modal-basic modal fade show" id="reagentModal" tabindex="-1" role="dialog" aria-hidden="true">
			    <div class="modal-dialog modal-md" role="document">
			        <div class="modal-content modal-bg-white">
			        	<div class="modal-header">
			        		<h6 class="modal-title">엑셀 업로드</h6>
		                    	<button type="button" class="close" data-dismiss="modal" aria-label="Close">
		                        	<span data-feather="x"></span>
		                        </button>
			        	</div>
			            <div class="modal-body">
			            	<div class="col-12">
				            	<form action="#">
				            		<div class="row">
				            			<div class="col-sm-3 d-flex aling-items-center mt-4">
		                                    <label class="color-dark align-center">엑셀 파일</label>
		                                </div>
		                                <div class="col-sm-5 mb-2">
		                                	<label for="uploadFile"></label>
		                                    <input type="file" id="uploadFile">
		                                </div>
				            		</div>
				            		<div class="button-group d-flex justify-content-end">
					                   <button class="btn btn-primary btn-default btn-squared">업로드</button>
					           		</div>
				            	</form>
			            	</div>
			            </div>
			        </div>
			    </div>
			</div>
		    <!-- ends: .modal-Basic -->
     
     	</div>
     
     </main>
     
     <!-- 공통 하단 -->
    <th:block th:include="/../fragments/footer.html"></th:block>
    <!-- 공통 js -->
    <th:block th:include="/../fragments/commonjs.html"></th:block>

<script type="text/javascript" th:inline="javascript">

function selectAll(selectAll)  {
	  const checkboxes 
	       = document.getElementsByName('user_id');
	  checkboxes.forEach((checkbox) => {
	    checkbox.checked = selectAll.checked;
	  })
	}
	
	var reagent = /*[[${reagent}]]*/ "null";
	
	//수정 페이지 접속 시 종류, 단위 선택해주기
	$("#reagent_type").val(reagent.reagent_type).prop("selected",true);
	$("#eaches_id").val(reagent.eaches_id).prop("selected",true);
	
	//수정 버튼 안내 팝업
	function UpdateBtn() {
		$("#update_popup").css("display", "flex");
	}
	//삭제 버튼 안내 팝업
	function DeleteBtn() {
		$("#delete_popup").css("display", "flex");
	}
	//팝업 취소
	function CancelBtn() {
		$("#update_popup").css("display", "none");
		$("#delete_popup").css("display", "none");
	}
	
	//시약 수정
	function updateConfirm(){
		
		var reagent_id = $("#reagent_id").val();
		var reagent_name = $.trim($("#reagent_name").val());
		var reagent_standard = $.trim($("#reagent_standard").val());
		var reagent_formula = $.trim($("#reagent_formula").val());
		var reagent_nick_k = $.trim($("#reagent_nick_k").val());
		var reagent_nick_e = $.trim($("#reagent_nick_e").val());
		var reagent_manufacturer = $.trim($("#reagent_manufacturer").val());
		var reagent_quantity = $.trim($("#reagent_quantity").val());
		var eaches_id = $.trim($("#eaches_id").val());
		var reagent_purpose = $.trim($("#reagent_purpose").val());
		var reagent_type = $.trim($("#reagent_type").val());
		
		if(reagent_type == ""){
			alert("종류를 선택해주세요.");
			$("#reagent_type").focus();
		}else if(reagent_name == ""){
			alert("품명를 선택하세요.");
			$("#reagent_name").focus();
		}else{
			var data = {
						"reagent_id" : reagent_id,
						"reagent_name" : reagent_name,
						"reagent_standard" : reagent_standard,
						"reagent_formula" : reagent_formula,
						"reagent_nick_k" : reagent_nick_k,
						"reagent_nick_e" : reagent_nick_e,
						"reagent_manufacturer" : reagent_manufacturer,
						"reagent_quantity" : reagent_quantity,
						"eaches_id" : eaches_id,
						"reagent_purpose" : reagent_purpose,
						"reagent_type" : reagent_type
						};
			
			$.ajax({
				url : "/data/reagent/updateReagent",
				method : "POST",
				dataType : "json",
				data : data,
				success : function(result){
					if(result == 0){
						
					}else {
						$("#update_popup").css("display", "none");
						$("#success_text").text("수정이 완료되었습니다.");
						$("#success_popup").css("display", "flex");
					}
				}
			});//end ajax
		}//end else
	}//end 시약 수정
	
	//농자재 삭제
	function deleteConfirm(){
		
		var reagent_id = $("#reagent_id").val();
		
		var data = {"reagent_id" : reagent_id};
		
		$.ajax({
			url : "/data/reagent/deleteReagent",
			method : "POST",
			dataType : "json",
			data : data,
			success : function(result){
				if(result == 0){
					
				}else {
					$("#delete_popup").css("display", "none");
					$("#success_text").text("삭제가 완료되었습니다.");
					$("#success_popup").css("display", "flex");
				}
			}
		});//end ajax
	}//end 시약 삭제

	//modal show
	$("#excelBtn").on("click", function(){
		$("#reagentModal").modal("show");
	});
	
	
	
</script>

</body>

</html>