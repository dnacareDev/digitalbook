<!doctype html>
<html lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<style>
	.content-header{margin-top:30px;}
	.end-button
	{
		width:85px;
		height:40px;
		background-color:#768BF5;
		border:0px;
		margin-top:-15px;
	}
	.end{margin-left:10px;}
</style>
<!-- 공통 헤더 -->
<th:block th:include="/../fragments/header.html"></th:block>
</head>
<body class="layout-light top-menu overlayScroll">
	<div class="mobile-search"></div>
	<div class="mobile-author-actions"></div>
	<!-- 공통 topbar -->
	<th:block th:include="/../fragments/topbar.html"></th:block>
	<main class="main-content" style="background-color: #F9FBFD;">
		<div class="contents" style="background-color: #F9FBFD;">
		    <div class="container-fluid">
		    	<div class="row">
			        <div class="col-lg-12">
			        	<div class="breadcrumb-main" style="float: left;">
			        		<h4 class="text-capitalize breadcrumb-title">종자(시료)</h4>
			        		<span class="ml-20 mt-1">기초정보-종자(시료)</span>
			        	</div>
			        </div>
		        </div>
		    	<div class="row">
			        <div class="col-lg-12">
			        	<div class="card">
			        		<div class="card-body">
			        			<div class="row">
			        				<div class="col-sm-2 checkbox-theme-default custom-checkbox">
			        					<input type="checkbox" id="not_report" class="checkbox">
			        					<label for="not_report">
			        						<span class="checkbox-text color-dark">과제 비연계</span>
			        					</label>
			        				</div>
			        			</div>
		        				<div class="row">
		        					<div class="col-sm-2 d-flex aling-items-center">
		                                   <label for="report_year" class="col-form-label color-dark align-center">과제명</label>
	                                </div>
	                                <div class="col-sm-8">
	                                	<input type="text" class="form-control b-light seed_code" id="report_code" th:data-report-code="${seeds.get(0).report_code}" th:value="${seeds.get(0).report_title}" readonly="readonly">
	                                </div>
		                         </div>
		                         <div class="row mt-3">
		        					<div class="col-sm-2 d-flex aling-items-center">
		                            	<label for="seed_report" class="color-dark align-center">과제설명</label>
		                            </div>
		                            <div class="col-sm-8">
		                                <textarea class="form-control" id="seed_report" rows="5" th:text="${seeds[0].seed_report}"></textarea>
		                            </div>
		                    	</div>
			        		</div>
			        	</div>
			        	<div class="card mt-4">
			        		<div class="card-body">
			        			<div class="columnGrid-wrapper">
				        			<div class="row">
			        					<div class="col-12" id="seed_form">
			        						<div class="card card-bordered form-standard">
				        						<div class="card-body ml-2 mt-3">
				        							<div class="row">
				        								<div class="col-11 col-md-11 col-lg-11">
					        								<div class="col-12 ml-1">
														        <div class="row">
														        	<div style="font-size: 17px; color: initial;">종자 및 시료관리</div>
														        </div>
													        </div>
													        <div class="col-12">
														        <div class="row mt-1">
														        	<div class="col-md-2 mb-25 d-flex aling-items-center">
						        										<label for="seed_code" class="color-dark fw-500 align-center mt-1">샘플 ID</label>
						        									</div>
						        									<div class="col-md-2 mb-25">
						        										<input type="text" class="form-control b-light seed_code" id="seed_code" readonly="readonly" style="width: 200px;">
						        									</div>
						        									<div class="col-md-2 mb-25">
						        										<button type="button" class="btn btn-sm btn-info">QR Code</button>
						        									</div>
														        </div>
													        </div>
						        							<div class="col-12">
						        								<div class="row mt-1">
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
						        										<label class="color-dark fw-500 align-center mt-1">품종/유전자원정보<span style="color: red;">*</span></label>
						        									</div>
						        									<div class="col-md-4 mb-25">
						        										<input type="text" class="form-control b-light genetic_id" style="float: left; width: 315px;" readonly="readonly">
						        										<label class="btn btn-light genetic_show">조회</label>
						        									</div>
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
									                                    <label for="seed_manager" class="color-dark fw-500 align-center">담당자<span style="color: red;">*</span></label>
									                                </div>
									                                <div class="col-md-4 mb-25">
						        										<select class="form-control b-light seed_manager" id="seed_manager">
											                                <option disabled="disabled" selected="selected" hidden="hidden">담당자 선택</option>
											                                <th:block th:each="user : ${user}">
											                                	<option th:value="${user.user_id}" th:text="${user.user_name_k}"></option>
											                                </th:block>
											                            </select>
						        									</div>
						        								</div>
						        								<div class="row">
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
						        										<label for="seed_area" class="color-dark fw-500 align-center mt-1">생산지역<span style="color: red;">*</span></label>
						        									</div>
						        									<div class="col-md-4 mb-25">
						        										<input type="text" class="form-control b-light seed_area" id="seed_area">
						        									</div>
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
									                                    <label for="seed_year" class="color-dark fw-500 align-center">생산연도<span style="color: red;">*</span></label>
									                                </div>
									                                <div class="col-md-4 mb-25">
						        										<input type="number" class="form-control b-light seed_year" id="seed_year">
						        									</div>
						        								</div>
						        								<div class="row">
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
						        										<label for="seed_method" class="color-dark fw-500 align-center mt-1">생산방법</label>
						        									</div>
						        									<div class="col-md-4 mb-25">
						        										<select class="form-control b-light seed_method" name="seed_method">
											                                <option value="">생산 방법 선택</option>
											                                <option value="시험연구">시험연구</option>
											                                <option value="증식">증식</option>
											                                <option value="구매">구매</option>
											                                <option value="외부농가">외부농가</option>
											                            </select>
						        									</div>
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
									                                    <label for="seed_amount" class="color-dark fw-500 align-center">수량(개수)<span style="color: red;">*</span></label>
									                                </div>
									                                <div class="col-md-2 mb-25">
						        										<input type="number" class="form-control b-light seed_amount" id="seed_amount">
						        									</div>
						        									<div class="col-md-2 mb-25">
						        										<select class="form-control b-light eaches_id" name="each" id="eaches_id">
											                                <option disabled="disabled" selected="selected" hidden="hidden">단위 선택</option>
											                                <th:block th:each="eaches : ${eaches}">
											                                	<option th:value="${eaches.eaches_id}" th:text="${eaches.eaches_name}"></option>
											                                </th:block>
											                            </select>
						        									</div>
						        								</div>
						        								<div class="row">
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
						        										<label for="ware_id" class="color-dark fw-500 align-center mt-1">저장장소<span style="color: red;">*</span></label>
						        									</div>
						        									<div class="col-md-4 mb-25">
						        										<select class="form-control b-light ware_id" name="ware_id" id="ware_id">
											                                <option disabled="disabled" selected="selected" hidden="hidden">저장 장소 선택</option>
											                                <th:block th:each="ware : ${warehouse}">
											                                	<option th:value="${ware.ware_id}" th:data-condition="${ware.ware_condition}" th:text="${ware.warehouse}"></option>
											                                </th:block>
											                            </select>
						        									</div>
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
									                                    <label for="ware_condition" class="color-dark fw-500 align-center">저장조건</label>
									                                </div>
									                                <div class="col-md-4 mb-25">
						        										<input type="text" class="form-control b-light ware_condition" id="ware_condition" readonly="readonly">
						        									</div>
						        								</div>
						        								<div class="row">
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
						        										<label for="seed_comment" class="color-dark fw-500 align-center">Comment</label>
						        									</div>
						        									<div class="col-md-10 mb-25">
						        										<textarea class="form-control seed_comment" id="seed_comment" rows="5"></textarea>
						        									</div>
						        								</div>
						        							</div>
						        							<div class="col-12 ml-1">
														        <div class="row">
														        	<div style="font-size: 17px; color: initial;">기타정보</div>
														        </div>
													        </div>
													        <div class="col-12">
						        								<div class="row mt-1">
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
									                                    <label for="seed_sender" class="color-dark fw-500 align-center">발송인 정보</label>
									                                </div>
									                                <div class="col-md-4 mb-25">
						        										<input type="text" class="form-control b-light seed_sender" id="seed_sender">
						        									</div>
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
						        										<label for="seed_sender" class="color-dark fw-500 align-center mt-1">수취인 정보</label>
						        									</div>
						        									<div class="col-md-4 mb-25">
						        										<select class="form-control b-light seed_receiver" name="seed_receiver" id="seed_receiver">
											                                <option th:value=0>수취인 선택</option>
											                                <th:block th:each="user : ${user}">
											                                	<option th:value="${user.user_id}" th:text="${user.user_name_k}"></option>
											                                </th:block>
											                            </select>
						        									</div>
						        								</div>
						        								<div class="row">
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
									                                    <label class="color-dark fw-500 align-center mt-1">발송일자</label>
									                                </div>
									                                <div class="col-md-4 mb-25">
						        										<input type="text" class="form-control b-light send_date send-datepicker0">
						        									</div>
						        									<div class="col-md-2 mb-25 d-flex aling-items-center">
						        										<label class="color-dark fw-500 align-center mt-1">수취일자</label>
						        									</div>
						        									<div class="col-md-4 mb-25">
						        										<input type="text" class="form-control b-light receive_date receive-datepicker0">
						        									</div>
						        								</div>
						        								<div class="row">
											        				<div class="col-sm-2 mb-4">
											        					<input type="checkbox" class="seed_share" th:value="0">
											        					<label>
											        						<span class="color-dark" th:text="${#authentication.principal.user_level} + | 공유|"></span>
											        					</label>
											        				</div>
											        			</div>
						        							</div>
					        							</div>
					        							<div class="col-1 col-md-1 col-lg-1 del_btn_div"></div>
				        							</div>
				        						</div>
				        					</div>
			        					</div>
		                        	</div>
		                    	</div>
			        		</div>
			        		<div class="d-flex justify-content-end mr-20 mb-20">
			                	<a class="btn btn-default" id="addseedFormBtn" style="background-color: #64DB99; color: white;">+추가</a>
			                </div>
			        	</div>
			        </div>
		        </div>
		        <div class="row">
					<div class="col-4">
						<div class="action-btn d-flex justify-content-frist mt-30">
							<th:block th:if="${#authentication.principal.user_type == 0 and seeds.get(0).seed_status == 0 or seeds.get(0).seed_status == 1 or seeds.get(0).seed_status == 3}">
								<button type="button" class="btn btn-default btn-info end-button end" onclick="UpdateStatusBtn();">승인</button>
							</th:block>
						</div>
					</div>
					<div class="col-4">
						<div class="d-flex justify-content-center mt-30"></div>
					</div>
					<div class="col-4">
						<div class="action-btn d-flex justify-content-end mt-30">
							<a href="/data/seed" class="btn btn-primary end-button end">목록</a>
							<button type="button" class="btn btn-default btn-danger end-button end" onclick="DeleteBtn();">삭제</button>
		                	<button type="button" class="btn btn-default btn-primary end-button end" onclick="UpdateBtn();">수정</button>
						</div>
					</div>
				</div>
				<div class="row mt-4">
					<div class="col-lg-12">
						<div class="card card-default">
							<div class="row ml-3 mt-3">
								<span class="color-dark align-center" style="font-size: 20px;">변경 이력</span>
							</div>
							<div class="card-body" style="height: 325px; overflow-y: auto;">
								<div class="row">
									<div class="col-lg-12">
										<ul>
											<th:block th:each="r : ${record}">
												<li class="mt-2">
													<span class="avatar avatar-success avatar-md avatar-circle" style="float: left;">
	                                                    <span class="avatar-icon" data-feather="check"></span>
	                                                </span>
													<div>
														<span class="font-weight-bold mb-0">시료 </span>
														<span class="font-weight-bold mb-0" th:text="${r.record_type_code}"></span>
														<th:block th:switch="${r.record_status}">
															<span th:case="0" class="font-weight-bold mb-0">승인요청</span>
															<span th:case="1" class="font-weight-bold mb-0">수정요청</span>
															<span th:case="2" class="font-weight-bold mb-0">승인</span>
															<span th:case="3" class="font-weight-bold mb-0">추가요청</span>
														</th:block>
													</div>
													<small th:text="${r.record_date}"></small>
												</li>
											</th:block>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
		        <div class="atbd-notice" id="success_popup" style="width:100vw; height:90vh; position:fixed; left:0px; top:0px; display:none; justify-content: center; align-items:center;">
		        	<div class="card card-default card-md mb-4" style="border:1px solid #eee; width: 30%; height: 40%;">
		        		<div class="card-body">
		        			<div class="atbd-notice__content">
		        				<div class="atbd-notice__top text-center">
		        					<div class="atbd-notice__icon bg-success">
		        						<i class="fas fa-check color-white"></i>
		        					</div>
		        					<div class="atbd-notice__text">
		        						<h4 id="success_text"></h4>
		        					</div>
		        					<div style="display: flex; justify-content: center; margin: 10% auto;">
		        						<a class="btn btn-default btn-success" href="/data/seed" style="color: #FFFFFF;">확인</a>
		        					</div>
		        				</div>
		        			</div>
		        		</div>
		        	</div>
		        </div>
		        <div class="atbd-notice" id="updateStatus_popup" style="width:100vw; height:90vh; position:fixed; left:0px; top:0px; display:none; justify-content: center; align-items:center;">
		        	<div class="card card-default card-md mb-4" style="border:1px solid #eee; width: 20%; height: 25%;">
		        		<div class="card-body">
		        			<div class="atbd-notice__content">
		        				<div class="atbd-notice__top text-center">
		        					<div class="atbd-notice__icon bg-info">
		        						<i class="fas fa-exclamation color-white"></i>
		        					</div>
		        					<div class="atbd-notice__text">
		        						<h4>승인 하시겠습니까?</h4>
		        					</div>
		        					<div style="display: flex; justify-content: center; margin: 10% auto;">
		        						<button class="btn btn-default btn-primary mr-10" onclick="UpdateStatus();" style="color: #FFFFFF;">승인</button>
		        						<button class="btn btn-default btn-danger" onclick="CancelBtn();" style="color: #FFFFFF;">취소</button>
		        					</div>
		        				</div>
		        			</div>
		        		</div>
		        	</div>
		        </div>
		        <div class="atbd-notice" id="update_popup" style="width:100vw; height:90vh; position:fixed; left:0px; top:0px; display:none; justify-content: center; align-items:center;">
		        	<div class="card card-default card-md mb-4" style="border:1px solid #eee; width: 20%; height: 25%;">
		        		<div class="card-body">
		        			<div class="atbd-notice__content">
		        				<div class="atbd-notice__top text-center">
		        					<div class="atbd-notice__icon bg-info">
		        						<i class="fas fa-exclamation color-white"></i>
		        					</div>
		        					<div class="atbd-notice__text">
		        						<h4>수정하시겠습니까?</h4>
		        					</div>
		        					<div style="display: flex; justify-content: center; margin: 10% auto;">
		        						<button class="btn btn-default btn-primary mr-10" onclick="updateConfirm();" style="color: #FFFFFF;">수정</button>
		        						<button class="btn btn-default btn-danger" onclick="CancelBtn();" style="color: #FFFFFF;">취소</button>
		        					</div>
		        				</div>
		        			</div>
		        		</div>
		        	</div>
		        </div>
		        <div class="atbd-notice" id="delete_popup" style="width:100vw; height:90vh; position:fixed; left:0px; top:0px; display:none; justify-content: center; align-items:center;">
		        	<div class="card card-default card-md mb-4" style="border:1px solid #eee; width: 20%; height: 25%;">
		        		<div class="card-body">
		        			<div class="atbd-notice__content">
		        				<div class="atbd-notice__top text-center">
		        					<div class="atbd-notice__icon bg-danger">
		        						<i class="fas fa-exclamation-triangle color-white"></i>
		        					</div>
		        					<div class="atbd-notice__text">
		        						<h4>삭제하시겠습니까?</h4>
		        					</div>
		        					<div style="display: flex; justify-content: center; margin: 10% auto;">
		        						<button class="btn btn-default btn-primary mr-10" onclick="deleteConfirm();" style="color: #FFFFFF;">삭제</button>
		        						<button class="btn btn-default btn-danger" onclick="CancelBtn();" style="color: #FFFFFF;">취소</button>
		        					</div>
		        				</div>
		        			</div>
		        		</div>
		        	</div>
		        </div>
		    </div>
			
			<div class="modal-basic modal fade show" id="seedModal" tabindex="-1" role="dialog" aria-hidden="true">
			    <div class="modal-dialog modal-md" role="document">
			        <div class="modal-content modal-bg-white">
			        	<div class="modal-header">
			        		<h6 class="modal-title">엑셀 업로드</h6>
		                    	<button type="button" class="close" data-dismiss="modal" aria-label="Close">
		                        	<span data-feather="x"></span>
		                        </button>
			        	</div>
			            <div class="modal-body">
			            	<div class="col-12">
				            	<form action="#">
				            		<div class="row">
				            			<div class="col-sm-3 d-flex aling-items-center mt-4">
		                                    <label class="color-dark align-center">엑셀 파일</label>
		                                </div>
		                                <div class="col-sm-5 mb-2">
		                                	<label for="uploadFile"></label>
		                                    <input type="file" id="uploadFile">
		                                </div>
				            		</div>
				            		<div class="button-group d-flex justify-content-end">
					                   <button class="btn btn-primary btn-default btn-squared">업로드</button>
					           		</div>
				            	</form>
			            	</div>
			            </div>
			        </div>
			    </div>
			</div>
		    <!-- ends: .modal-Basic -->
		    
		    <!-- 품종/유전정보 선택 modal -->
		    <div class="modal-basic modal fade show" id="geneticModal" tabindex="-1" role="dialog" aria-hidden="true">
			    <div class="modal-dialog modal-xl" role="document">
			        <div class="modal-content modal-bg-white">
			        	<div class="modal-header">
			        		<h6 class="modal-title">품종/유전정보 선택</h6>
		                    	<button type="button" class="close" data-dismiss="modal" aria-label="Close">
		                        	<span data-feather="x"></span>
		                        </button>
			        	</div>
			            <div class="modal-body">
			            	<div class="col-12">
				            	<div class="row">
				            		<div class="col-md-2 d-flex aling-items-center">
	                                    <label class="color-dark align-center">품종/유전정보 선택</label>
	                                </div>
				            		<div class="col-md-4">
					            		<div class="radio-horizontal-list d-flex">
					            			<div class="radio-theme-default custom-radio">
					            				<input class="radio" type="radio" name="radio" value=0 id="division_radio" checked="checked">
	                                            <label for="division_radio">
	                                                <span class="radio-text">품종</span>
	                                            </label>
					            			</div>
					            			<div class="radio-theme-default custom-radio">
					            				<input class="radio" type="radio" name="radio" value=1 id="genetic_radio">
	                                            <label for="genetic_radio">
	                                                <span class="radio-text">유전자원명</span>
	                                            </label>
					            			</div>
					            			<div class="radio-theme-default custom-radio">
					            				<input class="radio" type="radio" name="radio" value=2 id="etc_radio">
	                                            <label for="etc_radio">
	                                                <span class="radio-text">기타</span>
	                                            </label>
					            			</div>
					            		</div>
				            		</div>
				            	</div>
				            	<div class="row mt-2" id="division_row">
				            		<div class="col-md-2 mb-25 d-flex aling-items-center">
   										<label for="division_slt" class="color-dark fw-500 align-center mt-1" style="align-items: self-start">작목</label>
   									</div>
     								<div class="col-md-4 mb-25">
     									<select class="form-control b-light" name="division_slt" id="division_slt">
			                                <option value="0" disabled="disabled" selected="selected" hidden="hidden">작목명을 선택하세요</option>
			                                <th:block th:each="division : ${division}">
			                                	<option th:value="${division.division_id}" th:text="${division.division}"></option>
			                                </th:block>
		                            	</select>
     								</div>
     								<div class="col-md-6 d-flex" id="division_col">
	     								<div class="col-md-4 mb-25 d-flex aling-items-center">
	   										<label class="color-dark fw-500 align-center mt-1 genetic_title">품종</label>
	   									</div>
	     								<div class="col-md-8 mb-25">
	     									<select class="form-control b-light genetic_input">
				                                <option value="0">품종명을 선택하세요</option>
			                            	</select>
	     								</div>
     								</div>
     								<div class="col-md-6 d-flex" id="genetic_col">
	     								<div class="col-md-4 mb-25 d-flex aling-items-center">
	   										<label class="color-dark fw-500 align-center mt-1 genetic_title">유전자원명</label>
	   									</div>
	     								<div class="col-md-8 mb-25">
	     									<select class="form-control b-light genetic_input">
				                                <option value="0">유전자원명을 선택하세요</option>
			                            	</select>
	     								</div>
     								</div>
     								<div class="col-md-6 d-flex" id="etc_col">
	     								<div class="col-md-4 mb-25 d-flex aling-items-center">
	   										<label class="color-dark fw-500 align-center mt-1 genetic_title" style="align-items: self-start">기타</label>
	   									</div>
	     								<div class="col-md-8 mb-25" id="etc_inner_col">
	     									<select class="form-control b-light genetic_input">
				                                <option value="0">기타를 선택하세요</option>
			                            	</select>
	     								</div>
     								</div>
				            	</div>
				            	<div class="button-group d-flex justify-content-end">
				                   <button class="btn btn-primary btn-default btn-squared input_btn" onclick="useGenetic();">사용</button>
				           		</div>
			            	</div>
			            </div>
			        </div>
			    </div>
			</div>
		    <!-- ends: 품종/유전정보 선택 modal -->
     
     	</div>
     
     </main>
     
     <!-- 공통 하단 -->
    <th:block th:include="/../fragments/footer.html"></th:block>
    <!-- 공통 js -->
    <th:block th:include="/../fragments/commonjs.html"></th:block>

<script type="text/javascript" th:inline="javascript">

	var seeds = /*[[${seeds}]]*/ "null";	//시료 list
	
	var dataArr = new Array();		//수정할 데이터 Array
	var cancelArr = new Array();	//동적 태그 삭제 버튼 클릭시 삭제할 seed_id Array
	var seed_ids = new Array();		//삭제버튼 클릭시 삭제할 seed_id Array
	
	var this_1;		//품종, 유전장정보 input 태그
	
	var division_col = $("#division_col");
	var genetic_col = $("#genetic_col");
	var etc_col = $("#etc_col");
	
	var division_row = $("#division_row");
	
	var col_arr = new Array();
	col_arr[0] = division_col;
	col_arr[1] = genetic_col;
	col_arr[2] = etc_col;
	
	//종자 및 시료관리 폼 load 함수 실행
	loadSeedForm(seeds);
	
	//품종, 유전정보 모달에서 선택박스 선택 이벤트
	$("input:radio[name=radio]").on("change", function(){
		$("#division_slt").val(0).prop("selected",true);
		$(".genetic_input").val(0).prop("selected",true);
		if($("#division_radio").is(':checked')){
			genetic_col.remove();
			etc_col.remove();
			var str = col_arr[0];
			division_row.append(str);
		}else if($("#genetic_radio").is(':checked')){
			division_col.remove();
			etc_col.remove();
			var str = col_arr[1];
			division_row.append(str);
		}else if($("#etc_radio").is(':checked')){
			genetic_col.remove();
			division_col.remove();
			var str = col_arr[2];
			division_row.append(str);
		}
	});//end 품종, 유전정보 선택 이벤트
	
	//품종/유전정보 모달에서 기타 > 신규입력 선택 이벤트
	$(document).on("change", ".genetic_input", function(){
		
		var check = $(this).find("option:selected").val();
		if(check == "etc"){
			var etc_inner_col = $("#etc_inner_col");
			
			var str = '<input type="text" class="form-control" id="etc_input" style="margin-top: 10px;">';
			etc_inner_col.append(str);
		}
		
	});
	
	//작목명 선택할때 마다 품종 리스트 변경
	$("#division_slt").on("change", function()
	{
		var division_id = $(this).val();
		var genetic_type = $("input:radio[name=radio]:checked").val();
		var data = {"division_id" : division_id, "genetic_type" : genetic_type};
		
		$.ajax(
		{
			url : "/data/seed/selectGenetic",
			method : "POST",
			dataType : "json",
			data : data,
			success : function(genetic)
			{
				var genetic_input = $(".genetic_input");
				var add_list = "";
				
				if($("input:radio[name=radio]:checked").val() == 0)
				{
					add_list += '<option value="0">'+'품종명을 선택하세요'+'</option>';
				}
				else if($("input:radio[name=radio]:checked").val() == 1)
				{
					add_list += '<option value="0">'+'유전자원명을 선택하세요'+'</option>';
				}
				else if($("input:radio[name=radio]:checked").val() == 2)
				{
					add_list += '<option value="0">'+'기타를 선택하세요'+'</option>';
				}
				
				for(var i = 0; i < genetic.length; i++)
				{
					add_list += '<option value="' + genetic[i].genetic_id + '">' + genetic[i].genetic + '</option>';
				}
				
				if($("input:radio[name=radio]:checked").val() == 2){
					add_list += '<option value="etc">'+'신규입력'+'</option>';
				}
				
				genetic_input.empty();
				genetic_input.append(add_list);
			}
		});
	});// end 작목명 선택 이벤트
	
	//genetic etc 등록
	function insertGeneticEtc(){
		return new Promise(function(resolve){
			
			var genetic = $("#etc_input").val();
			var division_id = $("#division_slt option:selected").val();
			
			var data = {
					"genetic" : genetic,
					"division_id" : division_id
			};
			
			$.ajax({
				url : "/data/seed/insertGeneticEtc",
				method : "POST",
				dataType : 'json',
				data : data,
				success : function(result){
					if(result == 0){
						
					}else{
						resolve(result);
					}
				}
			});//end ajax
			
		});//end return
	}//end insertReport
	
	//품종, 유전정보 사용 버튼 이벤트
	function useGenetic(){
		var str1 = $("#division_slt option:selected").text();
		var str2 = "";
		
		if($(".genetic_input option:selected").val() == "0"){
			alert("품종/유전정보를 선택해주세요");
		}else if($(".genetic_input option:selected").val() == "etc" && $("#etc_input").val() == ""){
			alert("기타를 입력해 주세요");
		}else{
			
			if($(".genetic_input option:selected").val() == "etc"){
				
				
				insertGeneticEtc().then(function(result){
					
					if(result == 0){
						
					}else{
						str2 = $("#etc_input").val();
						var str = str1 + " > " + str2;
						
						this_1.val(str);
						var genetic_id = $(".genetic_input").val();
						this_1.attr('th:data-genetic-id', result);
						
						$("#geneticModal").modal("hide");
					}
					
				});
				
			}else{
				var str2 = $(".genetic_input option:selected").text();
				var str = str1 + " > " + str2;
				
				this_1.val(str);
				var genetic_id = $(".genetic_input").val();
				this_1.attr('th:data-genetic-id', genetic_id);
				
				$("#geneticModal").modal("hide");
			}//end else
				
		}//end else
		
	}
	
	//품종, 유전자정보 모달 show
	$(document).on("click", ".genetic_show", function(){
		$("#division_radio").prop("checked", true);
		$("#division_slt").val(0).prop("selected",true);
		$(".genetic_input").val(0).prop("selected",true);
		
		$("#geneticModal").modal("show");
		$("#etc_input").remove();
		var str = col_arr[0];
		division_row.append(str);
		genetic_col.remove();
		etc_col.remove();
		
		this_1 = $(this).prev();
		
	});
	
	//저장장소 선택에 따른 저장조건 이벤트
	$(document).on("change", ".ware_id", function(){
		ware_condition = $(this).find("option:selected").attr("data-condition");
		console.log(ware_condition);
		$(this).parent().parent().find(".ware_condition").val(ware_condition);
	});
	
	// seed 길이만큼 종자 및 시료관리 폼 load
	function loadSeedForm(seeds)
	{
		$("#seed_form").children(".form-standard").hide();									// 복사할 첫번째 폼은 숨기기
		
		var seed_form = $("#seed_form");
		var seed_form_inner = $("#seed_form").children(".form-standard").html();
		
		var str = "";																		// seed_form에 append 해줄 내용
		str += '<div class="card card-bordered copy-form-standard">';						// 실제 사용할 폼에 copy-form-standard 클래스 추가
		str += seed_form_inner;
		str += '</div>';
		
		// 과제 비연계시 체크박스 이벤트
		if(seeds[0].report_user_name === "0")
		{
			$("#not_report").prop("checked", true);
			$("#not_report").prop("disabled", true);
		}else{
			$("#not_report").prop("disabled", true);
		}
		
		// seeds 사이즈 만큼 seed_form 동적 생성
		var length = seeds.length;
		
		for(var i = 0; i < length; i++)
		{
			if(i === 0)
			{
				seed_form.append(str);
			}
			else
			{
				seed_form.append(str);
				
				var delbtn = "";																//삭제 버튼내용
				delbtn += '<button type="button" class="btn mt-25 mr-25 seed_form_del" th:data-seed-id="0" style="background-color: red; color: white; width: 70px;">-</button>';
				
				del_btn_form = $("#seed_form").children(":last").find(".del_btn_div");
				del_btn_form.append(delbtn);
			}
		}
		
		var hidden_seed_id = "";
		hidden_seed_id += '<input type="hidden" id="hidden_seed_id" value='+seeds[0].seed_id+'>';
		
		//동적 생성한 태그에 기존 값 노출
		$(document).find(".copy-form-standard").each(function(index, item)
		{
			if(index === 0)
			{
				$(this).find(".card-body").append(hidden_seed_id);
			}
			
			$(this).find(".seed_code").val(seeds[index].seed_code);
			$(this).find(".seed_manager").val(seeds[index].seed_manager).prop("selected", true);
			$(this).find(".seed_area").val(seeds[index].seed_area);
			$(this).find(".seed_year").val(seeds[index].seed_year);
			$(this).find(".seed_method").val(seeds[index].seed_method);
			$(this).find(".seed_amount").val(seeds[index].seed_amount);
			$(this).find(".eaches_id").val(seeds[index].eaches_id).prop("selected", true);
			$(this).find(".seed_comment").val(seeds[index].seed_comment);
			$(this).find(".genetic_id").attr("th:data-genetic-id", seeds[index].genetic_id);
			$(this).find(".genetic_id").val(seeds[index].division + " > " + seeds[index].genetic);
			$(this).find(".ware_id").val(seeds[index].ware_id).prop("selected", true);
			$(this).find(".ware_condition").val(seeds[index].ware_condition);
			$(this).find(".seed_sender").val(seeds[index].seed_sender);
			$(this).find(".send_date").val(seeds[index].send_date);
			$(this).find(".seed_receiver").val(seeds[index].seed_receiver);
			$(this).find(".receive_date").val(seeds[index].receive_date);
			$(this).find(".send_date").val(seeds[index].send_date);
			
			if(seeds[index].seed_share != 0)
			{
				$(this).find(".seed_share").val(seeds[index].seed_share).prop("checked", true);
			}
			
			if($(this).find(".seed_form_del").attr("th:data-seed-id") != undefined)
			{
				$(this).find(".seed_form_del").attr("th:data-seed-id", seeds[index].seed_id);
			}
		});
		
		//동적 생성된 datepicker 클래스에 datepicker 이벤트 주기
		$(".send_date").each(function(index)
		{
			if(index == 0)
			{
				return true;
			}
			else
			{
				$(this).addClass("send-datepicker"+index);
				
				$(".ui-datepicker-trigger").remove();
				$(".send-datepicker"+index).removeClass("hasDatepicker").removeAttr("id").datepicker();
			}
		});
		
		$(".receive_date").each(function(index)
		{
			if(index == 0)
			{
				return true;
			}
			else
			{
				$(this).addClass("receive-datepicker"+index);
				
				$(".ui-datepicker-trigger").remove();
				$(".receive-datepicker"+index).removeClass("hasDatepicker").removeAttr("id").datepicker();
			}
		});
	};
	
	//등록 폼 추가 이벤트
	$("#addseedFormBtn").on("click", function(){
		var seed_form = $("#seed_form");
		var seed_form_inner = $("#seed_form").children(".form-standard").html();
		
		var str = "";
		str += '<div class="card card-bordered copy-form-standard">';
		str += seed_form_inner;
		str += '</div>';
		
		seed_form.append(str);
		
		//삭제 버튼 추가
		var delbtn = "";
		delbtn += '<button type="button" class="btn mt-25 mr-25 seed_form_del" th:data-seed-id="0" style="background-color: red; color: white; width: 70px;">-</button>';
		
		del_btn_form = $("#seed_form").children(":last").find(".del_btn_div");
		del_btn_form.append(delbtn);
		
		//폼 추가 후 수확후 이용과 공유 값 초기화
		$("#seed_form").children(":last").find(".seed_share").val(0);
		
		//폼 추가 후 품종, 유전자원정보 th:data-genetic-id 삭제
		$("#seed_form").children(":last").find(".genetic_id").removeAttr("th:data-genetic-id");
		
		//동적 생성된 datepicker 클래스에 datepicker 이벤트 주기
		$(".send_date").each(function(index){
			if(index == 0){
				return true;
			}else{
				$(this).addClass("send-datepicker"+index);
				$(".ui-datepicker-trigger").remove();
				$(".send-datepicker"+index).removeClass("hasDatepicker").removeAttr("id").datepicker();
			}
		});
		
		$(".receive_date").each(function(index){
			if(index == 0){
				return true;
			}else{
				$(this).addClass("receive-datepicker"+index);
				$(".ui-datepicker-trigger").remove();
				$(".receive-datepicker"+index).removeClass("hasDatepicker").removeAttr("id").datepicker();
			}
		});
		
	});//end 등록 폼 추가 이벤트
	
	//동적으로 추가된 form 삭제 버튼 이벤트
	$(document).on("click", ".seed_form_del", function(){
		var delNum = $(this).attr("th:data-seed-id");
		if(delNum != "0"){
			cancelArr.push(delNum);
		}
		
		$(this).parent().parent().parent().parent().remove();
	});
	
	//수확후 이용과 공유 체크박스 이벤트
	$(document).on("change", ".seed_share", function(){
		if($(this).is(':checked')){
			$(this).val(1);
		}else{
			$(this).val(0);
		}
	});
	
	//시료 수정
	function updateConfirm(){
		
		/* console.log(dataArr);
		console.log(cancelArr); */
		
		$.ajax({
			url : "/data/seed/updateSeed?cancelArr="+cancelArr,
			method : "POST",
			contentType : "application/json; charset=utf-8",
			data : JSON.stringify(dataArr),
			success : function(result){
				
				if(result == 0){
					
				}else {
					$("#update_popup").css("display", "none");
					$("#success_text").text("수정이 완료되었습니다.");
					$("#success_popup").css("display", "flex");
				}
			}
		});//end ajax
		
	}//end 시료 등록

	//시료 삭제
	function deleteConfirm(){
		
		for(var i = 0; i < seeds.length; i++){
			seed_ids.push(seeds[i].seed_id);
		}
		
		$.ajax({
			url : "/data/seed/deleteSeed",
			method : "POST",
			contentType : "application/json; charset=utf-8",
			data : JSON.stringify(seed_ids),
			success : function(result){
				
				if(result == 0){
					
				}else {
					$("#delete_popup").css("display", "none");
					$("#success_text").text("삭제가 완료되었습니다.");
					$("#success_popup").css("display", "flex");
				}
			}
		});//end ajax
		
	}//end 시료 삭제
	
	//발송일자 datepicker
	$.datepicker.setDefaults({
		dateFormat: "yy-mm-dd",
      	duration: "medium",
      	changeMonth: true,
      	changeYear: true,
      	yearRange: "2010:2030",
	});
	
	//날짜 캘린더 동적 생성 다음주 와서 다시하기
	$(".send-datepicker0").datepicker();
	
	$(".receive-datepicker0").datepicker();
	
	//수정 버튼 안내 팝업
	function UpdateBtn()
	{
		var isValidate = false;
		
		//폼별로 값 가져오기 위한 each문
		$(".copy-form-standard").each(function(index, item)
		{
			if($(this).find(".genetic_id").attr("th:data-genetic-id") == undefined)
			{
				alert("품종/유전자 정보를 선택해주세요.");
				
				$(this).find(".genetic_id").focus();
				
				isValidate = false;
				
				return false;
			}
			else if($(this).find(".seed_manager").val() == null)
			{
				alert("담당자를 선택해주세요.");
				
				$(this).find(".seed_manager").focus();
				
				isValidate = false;
				
				return false;
			}
			else if($.trim($(this).find(".seed_area").val()) == "")
			{
				alert("생산지역을 입력해주세요.");
				
				$(this).find(".seed_area").focus();
				
				isValidate = false;
				
				return false;
			}
			else if($.trim($(this).find(".seed_year").val()) == "")
			{
				alert("생산연도를 입력해주세요.");
				
				$(this).find(".seed_year").focus();
				
				isValidate = false;
				
				return false;
			}
			else if($.trim($(this).find(".seed_amount").val()) == "")
			{
				alert("수량을 입력해주세요.");
				
				$(this).find(".seed_amount").focus();
				
				isValidate = false;
				
				return false;
			}
			else if($(this).find(".ware_id").val() == null)
			{
				alert("저장장소를 선택해주세요.");
				
				$(this).find(".ware_id").focus();
				
				isValidate = false;
				
				return false;
			}
			else
			{
				var seed_id = "";
				
				if(index == 0)
				{
					seed_id = $(this).find("#hidden_seed_id").val();
				}
				else
				{
					seed_id = $(this).find(".seed_form_del").attr("th:data-seed-id");
				}
				
				var data = {
						"seed_manager" : $(this).find(".seed_manager").val(),
						"seed_area" : $.trim($(this).find(".seed_area").val()),
						"seed_year" : $.trim($(this).find(".seed_year").val()),
						"seed_method" : $.trim($(this).find(".seed_method").val()),
						"seed_amount" : $.trim($(this).find(".seed_amount").val()),
						"eaches_id" : $(this).find(".eaches_id").val(),
						"seed_comment" : $.trim($(this).find(".seed_comment").val()),
						"genetic_id" : $(this).find(".genetic_id").attr("th:data-genetic-id"),
						"seed_report" : $.trim($("#seed_report").val()),
						"ware_id" : $(this).find(".ware_id").val(),
						"seed_sender" : $.trim($(this).find(".seed_sender").val()),
						"send_date" : $.trim($(this).find(".send_date").val()),
						"seed_receiver" : $(this).find(".seed_receiver").val(),
						"receive_date" : $.trim($(this).find(".receive_date").val()),
						"seed_share" : $(this).find(".seed_share").val(),
						"seed_id" : seed_id,
						"seed_code" : $(this).find(".seed_code").val(),
						"report_code" : $("#report_code").attr("data-report-code")
						};
				
				dataArr.push(data);
				isValidate = true;
			}
		});
		
		if(isValidate)
		{
			$("#update_popup").css("display", "flex");
		}
	}
	
	// 삭제 버튼 안내 팝업
	function DeleteBtn()
	{
		$("#delete_popup").css("display", "flex");
	}
	
	// 팝업 취소
	function CancelBtn()
	{
		$("#update_popup").css("display", "none");
		$("#delete_popup").css("display", "none");
	}
	
	//승인 버튼 안내 팝업
	function UpdateStatusBtn(){
		$("#updateStatus_popup").css("display", "flex");
	}
	
	//승인 함수
	function UpdateStatus(){
		
		$.ajax({
			url : "/data/seed/updateStatus",
			method : "POST",
			contentType : "application/json; charset=utf-8",
			data : JSON.stringify(seeds),
			success : function(result){
				
				if(result == 0){
					
				}else {
					$("#updateStatus_popup").css("display", "none");
					$("#success_text").text("승인 완료되었습니다.");
					$("#success_popup").css("display", "flex");
				}
			}
		});//end ajax
		
	}//end 승인 함수
	
</script>
</body>
</html>